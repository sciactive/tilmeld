/* http://kevin.vanzonneveld.net
+ original by: Webtoolkit.info (http://www.webtoolkit.info/)
+ improved by: Kevin van Zonneveld (http://kevin.vanzonneveld.net)
+ improved by: sowberry
+ tweaked by: Jack
+ bugfixed by: Onno Marsman
+ improved by: Yves Sucaet
+ bugfixed by: Onno Marsman
+ bugfixed by: Ulrich
* example 1: utf8_encode('Kevin van Zonneveld');
* returns 1: 'Kevin van Zonneveld'
*/
function utf8_encode(b){b=b+"";var e="",c,d,h=0;c=d=0;h=b.length;for(var f=0;f<h;f++){var a=b.charCodeAt(f),g=null;if(a<128)d++;else g=a>127&&a<2048?String.fromCharCode(a>>6|192)+String.fromCharCode(a&63|128):String.fromCharCode(a>>12|224)+String.fromCharCode(a>>6&63|128)+String.fromCharCode(a&63|128);if(g!==null){if(d>c)e+=b.substring(c,d);e+=g;c=d=f+1}}if(d>c)e+=b.substring(c,b.length);return e}
/* http://kevin.vanzonneveld.net
+ original by: Webtoolkit.info (http://www.webtoolkit.info/)
+ namespaced by: Michael White (http://getsprink.com)
+ tweaked by: Jack
+ improved by: Kevin van Zonneveld (http://kevin.vanzonneveld.net)
+ input by: Brett Zamir (http://brett-zamir.me)
+ bugfixed by: Kevin van Zonneveld (http://kevin.vanzonneveld.net)
- depends on: utf8_encode
* example 1: md5('Kevin van Zonneveld');
* returns 1: '6e658d4bfcb59cc13f96c14450ac40b9'
*/
function md5(s){var m=function(g,h){var j,l,n,k,i;n=g&2147483648;k=h&2147483648;j=g&1073741824;l=h&1073741824;i=(g&1073741823)+(h&1073741823);if(j&l)return i^2147483648^n^k;return j|l?i&1073741824?i^3221225472^n^k:i^1073741824^n^k:i^n^k},o=function(g,h,j,l,n,k,i){g=m(g,m(m(h&j|~h&l,n),i));return m(g<<k|g>>>32-k,h)},p=function(g,h,j,l,n,k,i){g=m(g,m(m(h&l|j&~l,n),i));return m(g<<k|g>>>32-k,h)},q=function(g,h,j,l,n,k,i){g=m(g,m(m(h^j^l,n),i));return m(g<<k|g>>>32-k,h)},r=function(g,h,j,l,n,k,i){g=m(g, m(m(j^(h|~l),n),i));return m(g<<k|g>>>32-k,h)},t=function(g){var h="",j="",l;for(l=0;l<=3;l++){j=g>>>l*8&255;j="0"+j.toString(16);h+=j.substr(j.length-2,2)}return h},f=[],e,u,v,w,x,a,b,c,d;s=this.utf8_encode(s);f=function(g){var h,j=g.length;h=j+8;for(var l=((h-h%64)/64+1)*16,n=Array(l-1),k=0,i=0;i<j;){h=(i-i%4)/4;k=i%4*8;n[h]|=g.charCodeAt(i)<<k;i++}h=(i-i%4)/4;k=i%4*8;n[h]|=128<<k;n[l-2]=j<<3;n[l-1]=j>>>29;return n}(s);a=1732584193;b=4023233417;c=2562383102;d=271733878;s=f.length;for(e=0;e<s;e+= 16){u=a;v=b;w=c;x=d;a=o(a,b,c,d,f[e+0],7,3614090360);d=o(d,a,b,c,f[e+1],12,3905402710);c=o(c,d,a,b,f[e+2],17,606105819);b=o(b,c,d,a,f[e+3],22,3250441966);a=o(a,b,c,d,f[e+4],7,4118548399);d=o(d,a,b,c,f[e+5],12,1200080426);c=o(c,d,a,b,f[e+6],17,2821735955);b=o(b,c,d,a,f[e+7],22,4249261313);a=o(a,b,c,d,f[e+8],7,1770035416);d=o(d,a,b,c,f[e+9],12,2336552879);c=o(c,d,a,b,f[e+10],17,4294925233);b=o(b,c,d,a,f[e+11],22,2304563134);a=o(a,b,c,d,f[e+12],7,1804603682);d=o(d,a,b,c,f[e+13],12,4254626195);c=o(c, d,a,b,f[e+14],17,2792965006);b=o(b,c,d,a,f[e+15],22,1236535329);a=p(a,b,c,d,f[e+1],5,4129170786);d=p(d,a,b,c,f[e+6],9,3225465664);c=p(c,d,a,b,f[e+11],14,643717713);b=p(b,c,d,a,f[e+0],20,3921069994);a=p(a,b,c,d,f[e+5],5,3593408605);d=p(d,a,b,c,f[e+10],9,38016083);c=p(c,d,a,b,f[e+15],14,3634488961);b=p(b,c,d,a,f[e+4],20,3889429448);a=p(a,b,c,d,f[e+9],5,568446438);d=p(d,a,b,c,f[e+14],9,3275163606);c=p(c,d,a,b,f[e+3],14,4107603335);b=p(b,c,d,a,f[e+8],20,1163531501);a=p(a,b,c,d,f[e+13],5,2850285829);d= p(d,a,b,c,f[e+2],9,4243563512);c=p(c,d,a,b,f[e+7],14,1735328473);b=p(b,c,d,a,f[e+12],20,2368359562);a=q(a,b,c,d,f[e+5],4,4294588738);d=q(d,a,b,c,f[e+8],11,2272392833);c=q(c,d,a,b,f[e+11],16,1839030562);b=q(b,c,d,a,f[e+14],23,4259657740);a=q(a,b,c,d,f[e+1],4,2763975236);d=q(d,a,b,c,f[e+4],11,1272893353);c=q(c,d,a,b,f[e+7],16,4139469664);b=q(b,c,d,a,f[e+10],23,3200236656);a=q(a,b,c,d,f[e+13],4,681279174);d=q(d,a,b,c,f[e+0],11,3936430074);c=q(c,d,a,b,f[e+3],16,3572445317);b=q(b,c,d,a,f[e+6],23,76029189); a=q(a,b,c,d,f[e+9],4,3654602809);d=q(d,a,b,c,f[e+12],11,3873151461);c=q(c,d,a,b,f[e+15],16,530742520);b=q(b,c,d,a,f[e+2],23,3299628645);a=r(a,b,c,d,f[e+0],6,4096336452);d=r(d,a,b,c,f[e+7],10,1126891415);c=r(c,d,a,b,f[e+14],15,2878612391);b=r(b,c,d,a,f[e+5],21,4237533241);a=r(a,b,c,d,f[e+12],6,1700485571);d=r(d,a,b,c,f[e+3],10,2399980690);c=r(c,d,a,b,f[e+10],15,4293915773);b=r(b,c,d,a,f[e+1],21,2240044497);a=r(a,b,c,d,f[e+8],6,1873313359);d=r(d,a,b,c,f[e+15],10,4264355552);c=r(c,d,a,b,f[e+6],15,2734768916); b=r(b,c,d,a,f[e+13],21,1309151649);a=r(a,b,c,d,f[e+4],6,4149444226);d=r(d,a,b,c,f[e+11],10,3174756917);c=r(c,d,a,b,f[e+2],15,718787259);b=r(b,c,d,a,f[e+9],21,3951481745);a=m(a,u);b=m(b,v);c=m(c,w);d=m(d,x)}return(t(a)+t(b)+t(c)+t(d)).toLowerCase()}
/* Whirlpool Hashing Function v3.0 ~ Sean Catchpole - Copyright 2009 Public Domain */
(function(){var o,f=[],s=[],d,h,u,t,A,v,B;for(d=8;d-- >0;)f[d]=[];for(h=0;h<256;h++){d="\u1823\uc6e8\u87b8\u014f\u36a6\ud2f5\u796f\u9152\u60bc\u9b8e\ua30c\u7b35\u1de0\ud7c2\u2e4b\ufe57\u1577\u37e5\u9ff0\u4ada\u58c9\u290a\ub1a0\u6b85\ubd5d\u10f4\ucb3e\u0567\ue427\u418b\ua77d\u95d8\ufbee\u7c66\udd17\u479e\uca2d\ubf07\uad5a\u8333\u6302\uaa71\uc819\u49d9\uf2e3\u5b88\u9a26\u32b0\ue90f\ud580\ubecd\u3448\uff7a\u905f\u2068\u1aae\ub454\u9322\u64f1\u7312\u4008\uc3ec\udba1\u8d3d\u9700\ucf2b\u7682\ud61b\ub5af\u6a50\u45f3\u30ef\u3f55\ua2ea\u65ba\u2fc0\ude1c\ufd4d\u9275\u068a\ub2e6\u0e1f\u62d4\ua896\uf9c5\u2559\u8472\u394c\u5e78\u388c\ud1a5\ue261\ub321\u9c1e\u43c7\ufc04\u5199\u6d0d\ufadf\u7e24\u3bab\uce11\u8f4e\ub7eb\u3c81\u94f7\ub913\u2cd3\ue76e\uc403\u5644\u7fa9\u2abb\uc153\udc0b\u9d6c\u3174\uf646\uac89\u14e1\u163a\u6909\u70b6\ud0ed\ucc42\u98a4\u285c\uf886".charCodeAt(h/ 2);d=(h&1)==0?d>>>8:d&255;u=d<<1;if(u>=256)u^=285;t=u<<1;if(t>=256)t^=285;A=t^d;v=t<<1;if(v>=256)v^=285;B=v^d;f[0][h]=[0,0];f[0][h][0]=d<<24|d<<16|t<<8|d;f[0][h][1]=v<<24|A<<16|u<<8|B;for(d=1;d<8;d++){f[d][h]=[0,0];f[d][h][0]=f[d-1][h][0]>>>8|f[d-1][h][1]<<24;f[d][h][1]=f[d-1][h][1]>>>8|f[d-1][h][0]<<24}}s[0]=[0,0];for(h=1;h<=10;h++){d=8*(h-1);s[h]=[0,0];s[h][0]=f[0][d][0]&4278190080^f[1][d+1][0]&16711680^f[2][d+2][0]&65280^f[3][d+3][0]&255;s[h][1]=f[4][d+4][1]&4278190080^f[5][d+5][1]&16711680^f[6][d+ 6][1]&65280^f[7][d+7][1]&255}var w=[],i=[],l=0,k=0,q=[],m=[],n=[],r=[],p=[],x=function(){var a,c,e,g,b;for(c=a=0;a<8;a++,c+=8){r[a]=[0,0];r[a][0]=(i[c]&255)<<24^(i[c+1]&255)<<16^(i[c+2]&255)<<8^i[c+3]&255;r[a][1]=(i[c+4]&255)<<24^(i[c+5]&255)<<16^(i[c+6]&255)<<8^i[c+7]&255}for(a=0;a<8;a++){p[a]=[0,0];m[a]=[0,0];p[a][0]=r[a][0]^(m[a][0]=q[a][0]);p[a][1]=r[a][1]^(m[a][1]=q[a][1])}for(e=1;e<=10;e++){for(a=0;a<8;a++){n[a]=[0,0];b=0;g=56;for(c=0;b<8;b++,g-=8,c=g<32?1:0){n[a][0]^=f[b][m[a-b&7][c]>>>g%32& 255][0];n[a][1]^=f[b][m[a-b&7][c]>>>g%32&255][1]}}for(a=0;a<8;a++){m[a][0]=n[a][0];m[a][1]=n[a][1]}m[0][0]^=s[e][0];m[0][1]^=s[e][1];for(a=0;a<8;a++){n[a][0]=m[a][0];n[a][1]=m[a][1];b=0;g=56;for(c=0;b<8;b++,g-=8,c=g<32?1:0){n[a][0]^=f[b][p[a-b&7][c]>>>g%32&255][0];n[a][1]^=f[b][p[a-b&7][c]>>>g%32&255][1]}}for(a=0;a<8;a++){p[a][0]=n[a][0];p[a][1]=n[a][1]}}for(a=0;a<8;a++){q[a][0]^=p[a][0]^r[a][0];q[a][1]^=p[a][1]^r[a][1]}};o=Whirlpool=function(a){return o.init().add(a).finalize()};o.version="3.0"; o.init=function(){for(var a=32;a-- >0;)w[a]=0;l=k=0;i=[0];for(a=8;a-- >0;)q[a]=[0,0];return o};o.add=function(a,c){if(!a)return o;if(!c){var e=a,g,b,j=e.toString();e=[];for(g=0;g<j.length;g++){b=j.charCodeAt(g);b>=256&&e.push(b>>>8&255);e.push(b&255)}a=e;c=a.length*8}e=0;g=8-(c&7)&7;b=l&7;var y,z=c;j=31;for(y=0;j>=0;j--){y+=(w[j]&255)+z%256;w[j]=y&255;y>>>=8;z=Math.floor(z/256)}for(;c>8;){j=a[e]<<g&255|(a[e+1]&255)>>>8-g;if(j<0||j>=256)return"Whirlpool requires a byte array";i[k++]|=j>>>b;l+=8-b; if(l==512){x();l=k=0;i=[]}i[k]=j<<8-b&255;l+=b;c-=8;e++}if(c>0){j=a[e]<<g&255;i[k]|=j>>>b}else j=0;if(!(b+c<8)){k++;l+=8-b;c-=8-b;if(l==512){x();l=k=0;i=[]}i[k]=j<<8-b&255}l+=c;return o};o.finalize=function(){var a,c,e,g="",b=[],j="0123456789ABCDEF".split("");i[k]|=128>>>(l&7);k++;if(k>32){for(;k<64;)i[k++]=0;x();k=0;i=[]}for(;k<32;)i[k++]=0;i.push.apply(i,w);x();for(c=a=0;a<8;a++,c+=8){e=q[a][0];b[c]=e>>>24&255;b[c+1]=e>>>16&255;b[c+2]=e>>>8&255;b[c+3]=e&255;e=q[a][1];b[c+4]=e>>>24&255;b[c+5]=e>>> 16&255;b[c+6]=e>>>8&255;b[c+7]=e&255}for(a=0;a<b.length;a++){g+=j[b[a]>>>4];g+=j[b[a]&15]}return g}})();